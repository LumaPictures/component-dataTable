<!DOCTYPE html><html lang="en"><head><title>mixins/collection</title></head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"><meta name="groc-relative-root" content="../"><meta name="groc-document-path" content="mixins/collection"><meta name="groc-project-path" content="lib/mixins/collection.coffee"><meta name="groc-github-url" content="https://github.com/lumapictures/jquery-datatables"><link rel="stylesheet" type="text/css" media="all" href="../assets/style.css"><script type="text/javascript" src="../assets/behavior.js"></script><body><div id="meta"><div class="file-path"><a href="https://github.com/lumapictures/jquery-datatables/blob/master/lib/mixins/collection.coffee">lib/mixins/collection.coffee</a></div></div><div id="document"><div class="segment"><div class="comments "><div class="wrapper"><h3 id="collection-counts">Collection Counts</h3>

<p>Datatables maintains counts of both the base query and filtered query reactively.
These counts are published by the datatables publication</p></div></div><div class="code"><div class="wrapper"><span class="nv">DataTableMixins.Collection =</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h4 id="collectionmeteorcollectionrequired"><code>collection</code> Meteor Collection ( required )</h4>

<p>This is the collection that houses the documents your datatable is displaying
and must be defined on both the client and the server.</p></div></div><div class="code"><div class="wrapper">  <span class="nv">setCollection: </span><span class="nf">( collection ) -&gt;</span>
    <span class="nx">Match</span><span class="p">.</span><span class="nx">test</span> <span class="nx">collection</span><span class="p">,</span> <span class="nb">Object</span>
    <span class="nx">@setData</span> <span class="s">&#39;collection&#39;</span><span class="p">,</span> <span class="nx">collection</span>
    <span class="nx">@log</span> <span class="s">&#39;collection:set&#39;</span><span class="p">,</span> <span class="nx">collection</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h5 id="setcountcollection">setCountCollection()</h5></div></div></div><div class="segment"><div class="code"><div class="wrapper">  <span class="nv">setCountCollection: </span><span class="nf">( collection ) -&gt;</span>
    <span class="nx">Match</span><span class="p">.</span><span class="nx">test</span> <span class="nx">collection</span><span class="p">,</span> <span class="nb">Object</span>
    <span class="nx">@setData</span> <span class="s">&#39;countCollection&#39;</span><span class="p">,</span> <span class="nx">collection</span>
    <span class="nx">@log</span> <span class="s">&#39;collection:count:set&#39;</span><span class="p">,</span> <span class="nx">collection</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h5 id="preparecollection">prepareCollection()</h5></div></div></div><div class="segment"><div class="code"><div class="wrapper">  <span class="nv">prepareCollection: </span><span class="nf">-&gt;</span>
    <span class="k">if</span> <span class="nx">@getCollection</span><span class="p">()</span> <span class="o">and</span> <span class="nx">@getQuery</span><span class="p">()</span>
      <span class="nx">@prepareCountCollection</span><span class="p">()</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h5 id="preparecountcollection">prepareCountCollection()</h5></div></div></div><div class="segment"><div class="code"><div class="wrapper">  <span class="nv">prepareCountCollection: </span><span class="nf">-&gt;</span>
    <span class="nv">collection = </span><span class="nx">@getData</span><span class="p">().</span><span class="nx">countCollection</span> <span class="o">or</span> <span class="nx">DataTable</span><span class="p">.</span><span class="nx">countCollection</span>
    <span class="nx">@setCountCollection</span> <span class="nx">collection</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h5 id="getcollection">getCollection()</h5></div></div></div><div class="segment"><div class="code"><div class="wrapper">  <span class="nv">getCollection: </span><span class="nf">-&gt;</span>
    <span class="k">return</span> <span class="nx">@getData</span><span class="p">().</span><span class="nx">collection</span> <span class="o">or</span> <span class="kc">false</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h5 id="getcountcollection">getCountCollection()</h5></div></div></div><div class="segment"><div class="code"><div class="wrapper">  <span class="nv">getCountCollection: </span><span class="nf">-&gt;</span>
    <span class="k">return</span> <span class="nx">@getData</span><span class="p">().</span><span class="nx">countCollection</span> <span class="o">or</span> <span class="kc">false</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h5 id="gettotalcount">getTotalCount()</h5></div></div></div><div class="segment"><div class="code"><div class="wrapper">  <span class="nv">getTotalCount: </span><span class="nf">-&gt;</span>
    <span class="k">return</span> <span class="nx">@getCountCollection</span><span class="p">().</span><span class="nx">findOne</span><span class="p">(</span> <span class="s">&quot;</span><span class="si">#{</span> <span class="nx">@getSubscription</span><span class="p">()</span> <span class="si">}</span><span class="s">&quot;</span> <span class="p">).</span><span class="nx">count</span> <span class="o">or</span> <span class="mi">0</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h5 id="getfilteredcount">getFilteredCount()</h5></div></div></div><div class="segment"><div class="code"><div class="wrapper">  <span class="nv">getFilteredCount: </span><span class="nf">-&gt;</span>
    <span class="k">return</span> <span class="nx">@getCountCollection</span><span class="p">().</span><span class="nx">findOne</span><span class="p">(</span> <span class="s">&quot;</span><span class="si">#{</span> <span class="nx">@getSubscription</span><span class="p">()</span> <span class="si">}</span><span class="s">_filtered&quot;</span> <span class="p">).</span><span class="nx">count</span> <span class="o">or</span> <span class="mi">0</span></div></div></div></div></body></html>